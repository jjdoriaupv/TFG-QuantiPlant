<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Configuraci贸n de la C谩mara</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h1>Configuraci贸n de la C谩mara</h1>
        <form method="POST" action="{{ url_for('config') }}">
            <!--  Configuraci贸n General -->
            <fieldset>
                <legend> Configuraci贸n General</legend>

                <label for="interval">Intervalo (segundos):</label>
                <input type="number" name="interval" min="1" value="{{ config.interval }}" required><br>

                <label for="exposure">Exposici贸n (microsegundos):</label>
                <input type="number" name="exposure" min="1" max="670000000" value="{{ config.exposure }}" required><br>

                <label for="max_photos">N煤mero de fotos a tomar:</label>
                <input type="number" name="max_photos" min="0" value="{{ config.max_photos }}"><br>

                <label for="folder_select">Elegir carpeta existente:</label>
                <select name="folder_select">
                    <option value="">-- Ninguna --</option>
                    {% for folder in folders %}
                        <option value="{{ folder }}" {% if folder == config.save_folder %}selected{% endif %}>{{ folder }}</option>
                    {% endfor %}
                </select><br>

                <label for="save_folder">O escribir nueva carpeta:</label>
                <input type="text" name="save_folder" value=""><br>
            </fieldset>

            <!--  Modo Captura Autom谩tica por Intervalos -->
            <fieldset>
                <legend> Captura por Intervalos</legend>

                <label>
                    <input type="checkbox" name="enabled" {% if config.enabled %}checked{% endif %}>
                    Captura autom谩tica habilitada
                </label><br>

                <label for="max_intervals">N煤mero de intervalos:</label>
                <input type="number" name="max_intervals" min="0" value="{{ config.max_intervals }}"><br>

                <label for="interval_between_bursts">Tiempo entre intervalos (segundos):</label>
                <input type="number" name="interval_between_bursts" min="1" value="{{ config.interval_between_bursts }}"><br>
            </fieldset>

            <!--  Modo R谩faga Avanzado -->
            <fieldset>
                <legend> Captura en R谩faga</legend>

                <label for="burst_mode_enabled">
                    <input type="checkbox" name="burst_mode_enabled" {% if config.burst_mode_enabled %}checked{% endif %}>
                    Usar modo r谩faga avanzada
                </label><br>

                <label for="burst_count">N煤mero de fotos por intervalo:</label>
                <input type="number" name="burst_count" min="0" value="{{ config.burst_count }}"><br>

                <label for="burst_interval">Tiempo entre fotos en r谩faga (segundos):</label>
                <input type="number" name="burst_interval" min="1" value="{{ config.burst_interval }}"><br>
            </fieldset>

            <!--  LED -->
            <fieldset>
                <legend> Configuraci贸n del LED</legend>

                <label>
                    <input type="checkbox" name="led_auto" {% if config.led_auto %}checked{% endif %}>
                    Control autom谩tico del LED
                </label><br>

                <label>
                    <input type="checkbox" name="led_enabled" {% if config.get('led_enabled', True) %}checked{% endif %}>
                    El LED debe estar encendido durante captura
                </label><br>
            </fieldset>

            <br>
            <button class="button" type="submit"> Guardar Configuraci贸n</button>
        </form>


        <div class="led-switch-container">
            <form method="POST" action="{{ url_for('toggle_usb') }}" id="led-switch-form">
                <label for="led-switch"> LED:</label>
                <label class="switch">
                    <input type="checkbox" name="led" id="led-switch" onchange="document.getElementById('led-switch-form').submit()" {% if led_state %}checked{% endif %}>
                    <span class="slider round"></span>
                </label>
            </form>
        </div>

        <br>
        <a class="button" href="{{ url_for('index') }}">猬锔 Volver al Panel</a>
    </div>
</body>
</html>
